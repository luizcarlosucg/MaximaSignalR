
@{
    ViewBag.Title = "Broadcast SQL";
}
<br />
<table style="width: 100%">
    <tr>
        <td style="width: 15%">
            <label for="idClient">Id Cliente:</label>
        </td>
        <td style="width: 85%">
            <input type="text" name="idClient" id="idClient" style="width: 80px" maxlength="5" />
        </td>
    </tr>
    <tr>
        <td>
            <label for="sql">Consulta Sql:</label>
        </td>
        <td>
            <input type="text" name="sql" id="sql" style="width: 700px" />
        </td>
    </tr>
</table>
<br />
<input type="button" id="btnEnviar" value="Enviar" />

<br />

<br />
<div id="resultado" style="width: 100%; height: 300px; overflow: scroll; border: 1px solid grey"></div>

<script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
<script src="~/signalr/hubs/" type="text/javascript"></script>

<script type="text/javascript">
    $(function () {
        var hub = $.connection.broadcastHub;

        hub.client.exibeResultado = function (dados) {
            var result = $("#resultado");
            result.html(result.html() + "<b>Dados do Cliente</b>:" + dados + "<br />");
        };

        $.connection.hub.start().done(function () {
            $("#btnEnviar").click(function () {
                hub.server.consultarDados($("#idClient").val(), $("#sql").val());
            });
        });
    });
</script>